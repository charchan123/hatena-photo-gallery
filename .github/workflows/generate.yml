name: Build & Deploy Photo Gallery

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 60     # â† é•·æ™‚é–“å®Ÿè¡Œã§ã‚‚å®‰å…¨

    # ä¸¦åˆ—ã‚¿ã‚¹ã‚¯ãŒå¤±æ•—ã—ã¦ã‚‚è½ã¨ã•ãªã„
    strategy:
      fail-fast: false

    env:
      HATENA_USER: ${{ secrets.HATENA_USER }}
      HATENA_BLOG_ID: ${{ secrets.HATENA_BLOG_ID }}
      HATENA_API_KEY: ${{ secrets.HATENA_API_KEY }}
      OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}

    steps:
      - name: ğŸ“¥ ãƒªãƒã‚¸ãƒˆãƒªå–å¾—
        uses: actions/checkout@v4

      - name: ğŸ Python ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
          cache: 'pip'

      - name: ğŸ“¦ ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: ğŸ”‘ ç’°å¢ƒå¤‰æ•°ãƒã‚§ãƒƒã‚¯
        run: |
          echo "=== ENV CHECK ==="
          if [ -z "$HATENA_USER" ]; then echo 'âŒ HATENA_USER mi]()
